var exec=require("child_process").exec,fs=require("fs"),path=require("path"),exists=fs.existsSync||path.existsSync,os=require("os"),quote=JSON.stringify,cmd;function which(b){var e=process.env.PATH.split(":");var d;for(var c=0,a=e.length;c<a;++c){d=path.join(e[c],b);if(exists(d)){return d}}}switch(os.type()){case"Darwin":if(which("terminal-notifier")){cmd={type:"Darwin-NotificationCenter",pkg:"terminal-notifier",msg:"-message",title:"-title",subtitle:"-subtitle",icon:"-appIcon",sound:"-sound",url:"-open",priority:{cmd:"-execute",range:[]}}}else{cmd={type:"Darwin-Growl",pkg:"growlnotify",msg:"-m",sticky:"--sticky",priority:{cmd:"--priority",range:[-2,-1,0,1,2,"Very Low","Moderate","Normal","High","Emergency"]}}}break;case"Linux":if(which("growl")){cmd={type:"Linux-Growl",pkg:"growl",msg:"-m",title:"-title",subtitle:"-subtitle",host:{cmd:"-H",hostname:"192.168.33.1"}}}else{cmd={type:"Linux",pkg:"notify-send",msg:"",sticky:"-t 0",icon:"-i",priority:{cmd:"-u",range:["low","normal","critical"]}}}break;case"Windows_NT":cmd={type:"Windows",pkg:"growlnotify",msg:"",sticky:"/s:true",title:"/t:",icon:"/i:",url:"/cu:",priority:{cmd:"/p:",range:[-2,-1,0,1,2]}};break}exports=module.exports=growl;exports.version="1.4.1";function growl(b,k,i){var c,f,k=k||{},i=i||function(){};if(k.exec){cmd={type:"Custom",pkg:k.exec,range:[]}}if(!cmd){return i(new Error("growl not supported on this platform"))}f=[cmd.pkg];if(c=k.image){switch(cmd.type){case"Darwin-Growl":var g,a=path.extname(c).substr(1);g=g||a=="icns"&&"iconpath";g=g||/^[A-Z]/.test(c)&&"appIcon";g=g||/^png|gif|jpe?g$/.test(a)&&"image";g=g||a&&(c=a)&&"icon";g=g||"icon";f.push("--"+g,quote(c));break;case"Darwin-NotificationCenter":f.push(cmd.icon,quote(c));break;case"Linux":f.push(cmd.icon,quote(c));if(!k.sticky){f.push("--hint=int:transient:1")}break;case"Windows":f.push(cmd.icon+quote(c));break}}if(k.sticky){f.push(cmd.sticky)}if(k.priority){var j=k.priority+"";var d=cmd.priority.range.indexOf(j);if(~cmd.priority.range.indexOf(j)){f.push(cmd.priority,k.priority)}}if(k.sound&&cmd.type==="Darwin-NotificationCenter"){f.push(cmd.sound,k.sound)}if(k.name&&cmd.type==="Darwin-Growl"){f.push("--name",k.name)}switch(cmd.type){case"Darwin-Growl":f.push(cmd.msg);f.push(quote(b).replace(/\\n/g,"\n"));if(k.title){f.push(quote(k.title))}break;case"Darwin-NotificationCenter":f.push(cmd.msg);var e=quote(b);var h=e.replace(/\\n/g,"\n");f.push(h);if(k.title){f.push(cmd.title);f.push(quote(k.title))}if(k.subtitle){f.push(cmd.subtitle);f.push(quote(k.subtitle))}if(k.url){f.push(cmd.url);f.push(quote(k.url))}break;case"Linux-Growl":f.push(cmd.msg);f.push(quote(b).replace(/\\n/g,"\n"));if(k.title){f.push(quote(k.title))}if(cmd.host){f.push(cmd.host.cmd,cmd.host.hostname)}break;case"Linux":if(k.title){f.push(quote(k.title));f.push(cmd.msg);f.push(quote(b).replace(/\\n/g,"\n"))}else{f.push(quote(b).replace(/\\n/g,"\n"))}break;case"Windows":f.push(quote(b).replace(/\\n/g,"\n"));if(k.title){f.push(cmd.title+quote(k.title))}if(k.url){f.push(cmd.url+quote(k.url))}break;case"Custom":f[0]=(function(m){var l=k.title?k.title+": "+b:b;var n=m.replace(/(^|[^%])%s/g,"$1"+quote(l));if(n===m){f.push(quote(l))}return n})(f[0]);break}exec(f.join(" "),i)};