module.exports=function(p,a){if(!a){a={}}var d={bools:{},strings:{}};[].concat(a["boolean"]).filter(Boolean).forEach(function(i){d.bools[i]=true});[].concat(a.string).filter(Boolean).forEach(function(i){d.strings[i]=true});var b={};Object.keys(a.alias||{}).forEach(function(i){b[i]=[].concat(a.alias[i]);b[i].forEach(function(j){b[j]=[i].concat(b[i].filter(function(m){return j!==m}))})});var f=a["default"]||{};var l={_:[]};Object.keys(d.bools).forEach(function(i){c(i,f[i]===undefined?false:f[i])});var s=[];if(p.indexOf("--")!==-1){s=p.slice(p.indexOf("--")+1);p=p.slice(0,p.indexOf("--"))}function c(i,m){var j=!d.strings[i]&&isNumber(m)?Number(m):m;setKey(l,i.split("."),j);(b[i]||[]).forEach(function(t){setKey(l,t.split("."),j)})}for(var h=0;h<p.length;h++){var r=p[h];if(/^--.+=/.test(r)){var e=r.match(/^--([^=]+)=([\s\S]*)$/);c(e[1],e[2])}else{if(/^--no-.+/.test(r)){var q=r.match(/^--no-(.+)/)[1];c(q,false)}else{if(/^--.+/.test(r)){var q=r.match(/^--(.+)/)[1];var k=p[h+1];if(k!==undefined&&!/^-/.test(k)&&!d.bools[q]&&(b[q]?!d.bools[b[q]]:true)){c(q,k);h++}else{if(/^(true|false)$/.test(k)){c(q,k==="true");h++}else{c(q,d.strings[q]?"":true)}}}else{if(/^-[^-]+/.test(r)){var o=r.slice(1,-1).split("");var n=false;for(var g=0;g<o.length;g++){var k=r.slice(g+2);if(k==="-"){c(o[g],k);continue}if(/[A-Za-z]/.test(o[g])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(k)){c(o[g],k);n=true;break}if(o[g+1]&&o[g+1].match(/\W/)){c(o[g],r.slice(g+2));n=true;break}else{c(o[g],d.strings[o[g]]?"":true)}}var q=r.slice(-1)[0];if(!n&&q!=="-"){if(p[h+1]&&!/^(-|--)[^-]/.test(p[h+1])&&!d.bools[q]&&(b[q]?!d.bools[b[q]]:true)){c(q,p[h+1]);h++}else{if(p[h+1]&&/true|false/.test(p[h+1])){c(q,p[h+1]==="true");h++}else{c(q,d.strings[q]?"":true)}}}}else{l._.push(d.strings._||!isNumber(r)?r:Number(r))}}}}}Object.keys(f).forEach(function(i){if(!hasKey(l,i.split("."))){setKey(l,i.split("."),f[i]);(b[i]||[]).forEach(function(j){setKey(l,j.split("."),f[i])})}});s.forEach(function(i){l._.push(i)});return l};function hasKey(c,b){var d=c;b.slice(0,-1).forEach(function(e){d=(d[e]||{})});var a=b[b.length-1];return a in d}function setKey(d,b,c){var e=d;b.slice(0,-1).forEach(function(f){if(e[f]===undefined){e[f]={}}e=e[f]});var a=b[b.length-1];if(e[a]===undefined||typeof e[a]==="boolean"){e[a]=c}else{if(Array.isArray(e[a])){e[a].push(c)}else{e[a]=[e[a],c]}}}function isNumber(a){if(typeof a==="number"){return true}if(/^0x[0-9a-f]+$/i.test(a)){return true}return/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(a)}function longest(a){return Math.max.apply(null,a.map(function(b){return b.length}))};