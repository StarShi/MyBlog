"use strict";var processNextTick=require("process-nextick-args");var objectKeys=Object.keys||function(c){var b=[];for(var a in c){b.push(a)}return b};module.exports=Duplex;var util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable");var Writable=require("./_stream_writable");util.inherits(Duplex,Readable);var keys=objectKeys(Writable.prototype);for(var v=0;v<keys.length;v++){var method=keys[v];if(!Duplex.prototype[method]){Duplex.prototype[method]=Writable.prototype[method]}}function Duplex(a){if(!(this instanceof Duplex)){return new Duplex(a)}Readable.call(this,a);Writable.call(this,a);if(a&&a.readable===false){this.readable=false}if(a&&a.writable===false){this.writable=false}this.allowHalfOpen=true;if(a&&a.allowHalfOpen===false){this.allowHalfOpen=false}this.once("end",onend)}function onend(){if(this.allowHalfOpen||this._writableState.ended){return}processNextTick(onEndNT,this)}function onEndNT(a){a.end()}Object.defineProperty(Duplex.prototype,"destroyed",{get:function(){if(this._readableState===undefined||this._writableState===undefined){return false}return this._readableState.destroyed&&this._writableState.destroyed},set:function(a){if(this._readableState===undefined||this._writableState===undefined){return}this._readableState.destroyed=a;this._writableState.destroyed=a}});Duplex.prototype._destroy=function(b,a){this.push(null);this.end();processNextTick(a,b)};function forEach(b,d){for(var c=0,a=b.length;c<a;c++){d(b[c],c)}};