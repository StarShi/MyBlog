const tcp=require("net");const CRLF="\r\n";function SMTPServer(a,b){this.options=a||{};this.server=tcp.createServer(this.process.bind(this,b))}SMTPServer.prototype.process=function(h,b){var c={};function a(i,j){b.write([i,j].join(" ")+CRLF)}var g="";function f(i){g+=(i+CRLF);switch(i.split(/\s/)[0]){case"HELO":case"EHLO":a(250,"OK");g="";break;case"MAIL":c.from=i.split(":")[1];a(250,"OK");g="";break;case"RCPT":(c.recipients||(c.recipients=[])).push(i.split(":")[1]);a(250,"OK");g="";break;case"DATA":a(354,"start input end with . (dot)");g="";break;case".":c.content=g;a(250,"Bye");g="";break;case"QUIT":h(c);b.end();break}}var d="",e=[];b.on("error",function(i){console.log(i)}).on("data",function(i){console.log(i);d+=i;e=d.split(CRLF);d=e.pop();e.forEach(f)});a(220,"Mail Server")};SMTPServer.prototype.listen=function(a,b){this.server.listen.apply(this.server,arguments)};module.exports=SMTPServer;