/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */
;"use strict";var PARAM_REGEXP=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g;var TEXT_REGEXP=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/;var TOKEN_REGEXP=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;var QESC_REGEXP=/\\([\u000b\u0020-\u00ff])/g;var QUOTE_REGEXP=/([\\"])/g;var TYPE_REGEXP=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;exports.format=format;exports.parse=parse;function format(e){if(!e||typeof e!=="object"){throw new TypeError("argument obj is required")}var d=e.parameters;var c=e.type;if(!c||!TYPE_REGEXP.test(c)){throw new TypeError("invalid type")}var a=c;if(d&&typeof d==="object"){var g;var f=Object.keys(d).sort();for(var b=0;b<f.length;b++){g=f[b];if(!TOKEN_REGEXP.test(g)){throw new TypeError("invalid parameter name")}a+="; "+g+"="+qstring(d[g])}}return a}function parse(c){if(!c){throw new TypeError("argument string is required")}var h=typeof c==="object"?getcontenttype(c):c;if(typeof h!=="string"){throw new TypeError("argument string is required to be a string")}var b=h.indexOf(";");var e=b!==-1?h.substr(0,b).trim():h.trim();if(!TYPE_REGEXP.test(e)){throw new TypeError("invalid media type")}var g=new ContentType(e.toLowerCase());if(b!==-1){var d;var a;var f;PARAM_REGEXP.lastIndex=b;while((a=PARAM_REGEXP.exec(h))){if(a.index!==b){throw new TypeError("invalid parameter format")}b+=a[0].length;d=a[1].toLowerCase();f=a[2];if(f[0]==='"'){f=f.substr(1,f.length-2).replace(QESC_REGEXP,"$1")}g.parameters[d]=f}if(b!==h.length){throw new TypeError("invalid parameter format")}}return g}function getcontenttype(a){var b;if(typeof a.getHeader==="function"){b=a.getHeader("content-type")}else{if(typeof a.headers==="object"){b=a.headers&&a.headers["content-type"]}}if(typeof b!=="string"){throw new TypeError("content-type header is missing from object")}return b}function qstring(b){var a=String(b);if(TOKEN_REGEXP.test(a)){return a}if(a.length>0&&!TEXT_REGEXP.test(a)){throw new TypeError("invalid parameter value")}return'"'+a.replace(QUOTE_REGEXP,"\\$1")+'"'}function ContentType(a){this.parameters=Object.create(null);this.type=a};