var SqlString=exports;var ID_GLOBAL_REGEXP=/`/g;var QUAL_GLOBAL_REGEXP=/\./g;var CHARS_GLOBAL_REGEXP=/[\0\b\t\n\r\x1a\"\'\\]/g;var CHARS_ESCAPE_MAP={"\0":"\\0","\b":"\\b","\t":"\\t","\n":"\\n","\r":"\\r","\x1a":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};SqlString.escapeId=function escapeId(d,a){if(Array.isArray(d)){var c="";for(var b=0;b<d.length;b++){c+=(b===0?"":", ")+SqlString.escapeId(d[b],a)}return c}else{if(a){return"`"+String(d).replace(ID_GLOBAL_REGEXP,"``")+"`"}else{return"`"+String(d).replace(ID_GLOBAL_REGEXP,"``").replace(QUAL_GLOBAL_REGEXP,"`.`")+"`"}}};SqlString.escape=function escape(c,a,b){if(c===undefined||c===null){return"NULL"}switch(typeof c){case"boolean":return(c)?"true":"false";case"number":return c+"";case"object":if(c instanceof Date){return SqlString.dateToString(c,b||"local")}else{if(Array.isArray(c)){return SqlString.arrayToList(c,b)}else{if(Buffer.isBuffer(c)){return SqlString.bufferToString(c)}else{if(typeof c.toSqlString==="function"){return String(c.toSqlString())}else{if(a){return escapeString(c.toString())}else{return SqlString.objectToValues(c,b)}}}}}default:return escapeString(c)}};SqlString.arrayToList=function arrayToList(e,a){var d="";for(var b=0;b<e.length;b++){var c=e[b];if(Array.isArray(c)){d+=(b===0?"":", ")+"("+SqlString.arrayToList(c,a)+")"}else{d+=(b===0?"":", ")+SqlString.escape(c,true,a)}}return d};SqlString.format=function format(i,g,d,h){if(g==null){return i}if(!(g instanceof Array||Array.isArray(g))){g=[g]}var c=0;var e=/\?\??/g;var j="";var a=0;var b;while(a<g.length&&(b=e.exec(i))){var f=b[0]==="??"?SqlString.escapeId(g[a]):SqlString.escape(g[a],d,h);j+=i.slice(c,b.index)+f;c=e.lastIndex;a++}if(c===0){return i}if(c<i.length){return j+i.slice(c)}return j};SqlString.dateToString=function dateToString(c,k){var b=new Date(c);if(isNaN(b.getTime())){return"NULL"}var i;var g;var j;var f;var d;var a;var l;if(k==="local"){i=b.getFullYear();g=b.getMonth()+1;j=b.getDate();f=b.getHours();d=b.getMinutes();a=b.getSeconds();l=b.getMilliseconds()}else{var e=convertTimezone(k);if(e!==false&&e!==0){b.setTime(b.getTime()+(e*60000))}i=b.getUTCFullYear();g=b.getUTCMonth()+1;j=b.getUTCDate();f=b.getUTCHours();d=b.getUTCMinutes();a=b.getUTCSeconds();l=b.getUTCMilliseconds()}var h=zeroPad(i,4)+"-"+zeroPad(g,2)+"-"+zeroPad(j,2)+" "+zeroPad(f,2)+":"+zeroPad(d,2)+":"+zeroPad(a,2)+"."+zeroPad(l,3);return escapeString(h)};SqlString.bufferToString=function bufferToString(a){return"X"+escapeString(a.toString("hex"))};SqlString.objectToValues=function objectToValues(b,a){var e="";for(var c in b){var d=b[c];if(typeof d==="function"){continue}e+=(e.length===0?"":", ")+SqlString.escapeId(c)+" = "+SqlString.escape(d,true,a)}return e};SqlString.raw=function raw(b){if(typeof b!=="string"){throw new TypeError("argument sql must be a string")}return{toSqlString:function a(){return b}}};function escapeString(d){var c=CHARS_GLOBAL_REGEXP.lastIndex=0;var a="";var b;while((b=CHARS_GLOBAL_REGEXP.exec(d))){a+=d.slice(c,b.index)+CHARS_ESCAPE_MAP[b[0]];c=CHARS_GLOBAL_REGEXP.lastIndex}if(c===0){return"'"+d+"'"}if(c<d.length){return"'"+a+d.slice(c)+"'"}return"'"+a+"'"}function zeroPad(b,a){b=b.toString();while(b.length<a){b="0"+b}return b}function convertTimezone(b){if(b==="Z"){return 0}var a=b.match(/([\+\-\s])(\d\d):?(\d\d)?/);if(a){return(a[1]==="-"?-1:1)*(parseInt(a[2],10)+((a[3]?parseInt(a[3],10):0)/60))*60}return false};