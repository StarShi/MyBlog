var crypto=require("crypto");exports.sign=function(b,a){if("string"!=typeof b){throw new TypeError("Cookie value must be provided as a string.")}if("string"!=typeof a){throw new TypeError("Secret string must be provided.")}return b+"."+crypto.createHmac("sha256",a).update(b).digest("base64").replace(/\=+$/,"")};exports.unsign=function(c,a){if("string"!=typeof c){throw new TypeError("Signed cookie string must be provided.")}if("string"!=typeof a){throw new TypeError("Secret string must be provided.")}var b=c.slice(0,c.lastIndexOf(".")),d=exports.sign(b,a);return sha1(d)==sha1(c)?b:false};function sha1(a){return crypto.createHash("sha1").update(a).digest("hex")};