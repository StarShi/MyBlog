"use strict";var Buffer=require("buffer").Buffer,Transform=require("stream").Transform;module.exports=function(a){a.encodeStream=function c(e,d){return new IconvLiteEncoderStream(a.getEncoder(e,d),d)};a.decodeStream=function b(e,d){return new IconvLiteDecoderStream(a.getDecoder(e,d),d)};a.supportsStreams=true;a.IconvLiteEncoderStream=IconvLiteEncoderStream;a.IconvLiteDecoderStream=IconvLiteDecoderStream;a._collect=IconvLiteDecoderStream.prototype.collect};function IconvLiteEncoderStream(b,a){this.conv=b;a=a||{};a.decodeStrings=false;Transform.call(this,a)}IconvLiteEncoderStream.prototype=Object.create(Transform.prototype,{constructor:{value:IconvLiteEncoderStream}});IconvLiteEncoderStream.prototype._transform=function(b,d,a){if(typeof b!="string"){return a(new Error("Iconv encoding stream needs strings as its input."))}try{var c=this.conv.write(b);if(c&&c.length){this.push(c)}a()}catch(f){a(f)}};IconvLiteEncoderStream.prototype._flush=function(a){try{var b=this.conv.end();if(b&&b.length){this.push(b)}a()}catch(c){a(c)}};IconvLiteEncoderStream.prototype.collect=function(a){var b=[];this.on("error",a);this.on("data",function(c){b.push(c)});this.on("end",function(){a(null,Buffer.concat(b))});return this};function IconvLiteDecoderStream(b,a){this.conv=b;a=a||{};a.encoding=this.encoding="utf8";Transform.call(this,a)}IconvLiteDecoderStream.prototype=Object.create(Transform.prototype,{constructor:{value:IconvLiteDecoderStream}});IconvLiteDecoderStream.prototype._transform=function(b,d,a){if(!Buffer.isBuffer(b)){return a(new Error("Iconv decoding stream needs buffers as its input."))}try{var c=this.conv.write(b);if(c&&c.length){this.push(c,this.encoding)}a()}catch(f){a(f)}};IconvLiteDecoderStream.prototype._flush=function(a){try{var b=this.conv.end();if(b&&b.length){this.push(b,this.encoding)}a()}catch(c){a(c)}};IconvLiteDecoderStream.prototype.collect=function(a){var b="";this.on("error",a);this.on("data",function(c){b+=c});this.on("end",function(){a(null,b)});return this};