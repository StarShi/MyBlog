"use strict";module.exports=function(g,f,a){var d=require("./util");var c=require("./errors").RangeError;var i=require("./errors").AggregateError;var e=d.isArray;var j={};function b(k){this.constructor$(k);this._howMany=0;this._unwrap=false;this._initialized=false}d.inherits(b,f);b.prototype._init=function(){if(!this._initialized){return}if(this._howMany===0){this._resolve([]);return}this._init$(undefined,-5);var k=e(this._values);if(!this._isResolved()&&k&&this._howMany>this._canPossiblyFulfill()){this._reject(this._getRangeError(this.length()))}};b.prototype.init=function(){this._initialized=true;this._init()};b.prototype.setUnwrap=function(){this._unwrap=true};b.prototype.howMany=function(){return this._howMany};b.prototype.setHowMany=function(k){this._howMany=k};b.prototype._promiseFulfilled=function(k){this._addFulfilled(k);if(this._fulfilled()===this.howMany()){this._values.length=this.howMany();if(this.howMany()===1&&this._unwrap){this._resolve(this._values[0])}else{this._resolve(this._values)}return true}return false};b.prototype._promiseRejected=function(k){this._addRejected(k);return this._checkOutcome()};b.prototype._promiseCancelled=function(){if(this._values instanceof g||this._values==null){return this._cancel()}this._addRejected(j);return this._checkOutcome()};b.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){var l=new i();for(var k=this.length();k<this._values.length;++k){if(this._values[k]!==j){l.push(this._values[k])}}if(l.length>0){this._reject(l)}else{this._cancel()}return true}return false};b.prototype._fulfilled=function(){return this._totalResolved};b.prototype._rejected=function(){return this._values.length-this.length()};b.prototype._addRejected=function(k){this._values.push(k)};b.prototype._addFulfilled=function(k){this._values[this._totalResolved++]=k};b.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()};b.prototype._getRangeError=function(l){var k="Input array must contain at least "+this._howMany+" items but contains only "+l+" items";return new c(k)};b.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))};function h(m,l){if((l|0)!==l||l<0){return a("expecting a positive integer\u000a\u000a    See http://goo.gl/MqrFmX\u000a")}var k=new b(m);var n=k.promise();k.setHowMany(l);k.init();return n}g.some=function(l,k){return h(l,k)};g.prototype.some=function(k){return h(this,k)};g._SomePromiseArray=b};