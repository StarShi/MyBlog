"use strict";var util=require("./util");var maybeWrapAsError=util.maybeWrapAsError;var errors=require("./errors");var OperationalError=errors.OperationalError;var es5=require("./es5");function isUntypedError(a){return a instanceof Error&&es5.getPrototypeOf(a)===Error.prototype}var rErrorKey=/^(?:name|message|stack|cause)$/;function wrapAsOperationalError(e){var a;if(isUntypedError(e)){a=new OperationalError(e);a.name=e.name;a.message=e.message;a.stack=e.stack;var d=es5.keys(e);for(var c=0;c<d.length;++c){var b=d[c];if(!rErrorKey.test(b)){a[b]=e[b]}}return a}util.markAsOriginatingFromRejection(e);return e}function nodebackForPromise(a,b){return function(f,g){if(a===null){return}if(f){var c=wrapAsOperationalError(maybeWrapAsError(f));a._attachExtraTrace(c);a._reject(c)}else{if(!b){a._fulfill(g)}else{var h=arguments.length;var d=new Array(Math.max(h-1,0));for(var e=1;e<h;++e){d[e-1]=arguments[e]}a._fulfill(d)}}a=null}}module.exports=nodebackForPromise;