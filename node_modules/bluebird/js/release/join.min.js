"use strict";module.exports=function(e,r,h,b,g,p){var a=require("./util");var m=a.canEvaluate;var l=a.tryCatch;var k=a.errorObj;var f;if(!false){if(m){var j=function(t){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,t))};var s=function(t){return new Function("promise","holder","                           \n            'use strict';                                                    \n            holder.pIndex = promise;                                         \n            ".replace(/Index/g,t))};var d=function(y){var w=new Array(y);for(var v=0;v<w.length;++v){w[v]="this.p"+(v+1)}var A=w.join(" = ")+" = null;";var z="var promise;\n"+w.map(function(i){return"                                                         \n                promise = "+i+";                                      \n                if (promise instanceof Promise) {                            \n                    promise.cancel();                                        \n                }                                                            \n            "}).join("\n");var t=w.join(", ");var u="Holder$"+y;var x="return function(tryCatch, errorObj, Promise, async) {    \n            'use strict';                                                    \n            function [TheName](fn) {                                         \n                [TheProperties]                                              \n                this.fn = fn;                                                \n                this.asyncNeeded = true;                                     \n                this.now = 0;                                                \n            }                                                                \n                                                                             \n            [TheName].prototype._callFunction = function(promise) {          \n                promise._pushContext();                                      \n                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n                promise._popContext();                                       \n                if (ret === errorObj) {                                      \n                    promise._rejectCallback(ret.e, false);                   \n                } else {                                                     \n                    promise._resolveCallback(ret);                           \n                }                                                            \n            };                                                               \n                                                                             \n            [TheName].prototype.checkFulfillment = function(promise) {       \n                var now = ++this.now;                                        \n                if (now === [TheTotal]) {                                    \n                    if (this.asyncNeeded) {                                  \n                        async.invoke(this._callFunction, this, promise);     \n                    } else {                                                 \n                        this._callFunction(promise);                         \n                    }                                                        \n                                                                             \n                }                                                            \n            };                                                               \n                                                                             \n            [TheName].prototype._resultCancelled = function() {              \n                [CancellationCode]                                           \n            };                                                               \n                                                                             \n            return [TheName];                                                \n        }(tryCatch, errorObj, Promise, async);                               \n        ";x=x.replace(/\[TheName\]/g,u).replace(/\[TheTotal\]/g,y).replace(/\[ThePassedArguments\]/g,t).replace(/\[TheProperties\]/g,A).replace(/\[CancellationCode\]/g,z);return new Function("tryCatch","errorObj","Promise","async",x)(l,k,e,g)};var c=[];var q=[];var n=[];for(var o=0;o<8;++o){c.push(d(o+1));q.push(j(o+1));n.push(s(o+1))}f=function(i){this._reject(i)}}}e.join=function(){var F=arguments.length-1;var C;if(F>0&&typeof arguments[F]==="function"){C=arguments[F];if(!false){if(F<=8&&m){var z=new e(b);z._captureStackTrace();var w=c[F-1];var D=new w(C);var y=q;for(var v=0;v<F;++v){var E=h(arguments[v],z);if(E instanceof e){E=E._target();var x=E._bitField;if(((x&50397184)===0)){E._then(y[v],f,undefined,z,D);n[v](E,D);D.asyncNeeded=false}else{if(((x&33554432)!==0)){y[v].call(z,E._value(),D)}else{if(((x&16777216)!==0)){z._reject(E._reason())}else{z._cancel()}}}}else{y[v].call(z,E,D)}}if(!z._isFateSealed()){if(D.asyncNeeded){var u=p();if(u!==null){D.fn=a.domainBind(u,D.fn)}}z._setAsyncGuaranteed();z._setOnCancel(D)}return z}}}var B=arguments.length;var A=new Array(B);for(var t=0;t<B;++t){A[t]=arguments[t]}if(C){A.pop()}var z=new r(A).promise();return C!==undefined?z.spread(C):z}};