"use strict";var Base=require("./base");var utils=require("../utils");var SUITE_PREFIX="$";exports=module.exports=Markdown;function Markdown(d){Base.call(this,d);var g=0;var b="";function f(h){return Array(g).join("#")+" "+h}function a(j,k){var h=k;var i=SUITE_PREFIX+j.title;k=k[i]=k[i]||{suite:j};j.suites.forEach(function(l){a(l,k)});return h}function e(k,l){++l;var h="";var j;for(var i in k){if(i==="suite"){continue}if(i!==SUITE_PREFIX){j=" - ["+i.substring(1)+"]";j+="(#"+utils.slug(k[i].suite.fullTitle())+")\n";h+=Array(l).join("  ")+j}h+=e(k[i],l)}return h}function c(h){var i=a(h,{});return e(i,0)}c(d.suite);d.on("suite",function(i){++g;var h=utils.slug(i.fullTitle());b+='<a name="'+h+'"></a>\n';b+=f(i.title)+"\n"});d.on("suite end",function(){--g});d.on("pass",function(i){var h=utils.clean(i.body);b+=i.title+".\n";b+="\n```js\n";b+=h+"\n";b+="```\n\n"});d.on("end",function(){process.stdout.write("# TOC\n");process.stdout.write(c(d.suite));process.stdout.write(b)})};