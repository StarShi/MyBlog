"use strict";exports.__esModule=true;exports.jsonDiff=undefined;var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};exports.diffJson=diffJson;exports.canonicalize=canonicalize;var _base=require("./base");var _base2=_interopRequireDefault(_base);var _line=require("./line");function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}}var objectPrototypeToString=Object.prototype.toString;var jsonDiff=exports.jsonDiff=new _base2["default"]();jsonDiff.useLongestToken=true;jsonDiff.tokenize=_line.lineDiff.tokenize;jsonDiff.castInput=function(b){var a=this.options.undefinedReplacement;return typeof b==="string"?b:JSON.stringify(canonicalize(b),function(d,c){if(typeof c==="undefined"){return a}return c},"  ")};jsonDiff.equals=function(b,a){return(_base2["default"].prototype.equals(b.replace(/,([\r\n])/g,"$1"),a.replace(/,([\r\n])/g,"$1")))};function diffJson(a,b,c){return jsonDiff.diff(a,b,c)}function canonicalize(f,a,g){a=a||[];g=g||[];var e=void 0;for(e=0;e<a.length;e+=1){if(a[e]===f){return g[e]}}var b=void 0;if("[object Array]"===objectPrototypeToString.call(f)){a.push(f);b=new Array(f.length);g.push(b);for(e=0;e<f.length;e+=1){b[e]=canonicalize(f[e],a,g)}a.pop();g.pop();return b}if(f&&f.toJSON){f=f.toJSON()}if((typeof f==="undefined"?"undefined":_typeof(f))==="object"&&f!==null){a.push(f);b={};g.push(b);var c=[],d=void 0;for(d in f){if(f.hasOwnProperty(d)){c.push(d)}}c.sort();for(e=0;e<c.length;e+=1){d=c[e];b[d]=canonicalize(f[d],a,g)}a.pop();g.pop()}else{b=f}return b};