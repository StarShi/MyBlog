/*!
 * keygrip
 * Copyright(c) 2011-2014 Jed Schmidt
 * MIT Licensed
 */
;var crypto=require("crypto");function Keygrip(d,b,c){if(!b){b="sha1"}if(!c){c="base64"}if(!(this instanceof Keygrip)){return new Keygrip(d,b,c)}if(!d||!(0 in d)){throw new Error("Keys must be provided.")}function a(f,e){return crypto.createHmac(b,e).update(f).digest(c).replace(/\/|\+|=/g,function(g){return({"/":"_","+":"-","=":""})[g]})}this.sign=function(e){return a(e,d[0])};this.verify=function(e,f){return this.index(e,f)>-1};this.index=function(g,h){for(var f=0,e=d.length;f<e;f++){if(constantTimeCompare(h,a(g,d[f]))){return f}}return -1}}Keygrip.sign=Keygrip.verify=Keygrip.index=function(){throw new Error("Usage: require('keygrip')(<array-of-keys>)")};var constantTimeCompare=function(d,c){if(d==null&&c!=null){return false}else{if(c==null&&d!=null){return false}else{if(d==null&&c==null){return true}}}if(d.length!==c.length){return false}var a=0;for(var b=0;b<d.length;b++){a|=d.charCodeAt(b)^c.charCodeAt(b)}return a===0};module.exports=Keygrip;