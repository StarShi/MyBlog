/*!
 * vary
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */
;"use strict";module.exports=vary;module.exports.append=append;var FIELD_NAME_REGEXP=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/;function append(h,f){if(typeof h!=="string"){throw new TypeError("header argument is required")}if(!f){throw new TypeError("field argument is required")}var a=!Array.isArray(f)?parse(String(f)):f;for(var b=0;b<a.length;b++){if(!FIELD_NAME_REGEXP.test(a[b])){throw new TypeError("field argument contains an invalid header name")}}if(h==="*"){return h}var g=h;var e=parse(h.toLowerCase());if(a.indexOf("*")!==-1||e.indexOf("*")!==-1){return"*"}for(var d=0;d<a.length;d++){var c=a[d].toLowerCase();if(e.indexOf(c)===-1){e.push(c);g=g?g+", "+a[d]:a[d]}}return g}function parse(f){var b=0;var d=[];var e=0;for(var c=0,a=f.length;c<a;c++){switch(f.charCodeAt(c)){case 32:if(e===b){e=b=c+1}break;case 44:d.push(f.substring(e,b));e=b=c+1;break;default:b=c+1;break}}d.push(f.substring(e,b));return d}function vary(a,b){if(!a||!a.getHeader||!a.setHeader){throw new TypeError("res argument is required")}var c=a.getHeader("Vary")||"";var d=Array.isArray(c)?c.join(", "):String(c);if((c=append(d,b))){a.setHeader("Vary",c)}};