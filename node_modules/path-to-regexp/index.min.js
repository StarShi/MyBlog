module.exports=pathtoRegexp;var MATCHING_GROUP_REGEXP=/\((?!\?)/g;function pathtoRegexp(n,k,o){o=o||{};k=k||[];var j=o.strict;var d=o.end!==false;var b=o.sensitive?"":"i";var h=0;var l=k.length;var f=0;var a=0;var c;if(n instanceof RegExp){while(c=MATCHING_GROUP_REGEXP.exec(n.source)){k.push({name:a++,optional:false,offset:c.index})}return n}if(Array.isArray(n)){n=n.map(function(i){return pathtoRegexp(i,k,o).source});return new RegExp("(?:"+n.join("|")+")",b)}n=("^"+n+(j?"":n[n.length-1]==="/"?"?":"/?")).replace(/\/\(/g,"/(?:").replace(/([\/\.])/g,"\\$1").replace(/(\\\/)?(\\\.)?:(\w+)(\(.*?\))?(\*)?(\?)?/g,function(p,m,s,t,u,q,r,i){m=m||"";s=s||"";u=u||"([^\\/"+s+"]+?)";r=r||"";k.push({name:t,optional:!!r,offset:i+h});var v=""+(r?"":m)+"(?:"+s+(r?m:"")+u+(q?"((?:[\\/"+s+"].+?)?)":"")+")"+r;h+=v.length-p.length;return v}).replace(/\*/g,function(p,m){var i=k.length;while(i-->l&&k[i].offset>m){k[i].offset+=3}return"(.*)"});while(c=MATCHING_GROUP_REGEXP.exec(n)){var e=0;var g=c.index;while(n.charAt(--g)==="\\"){e++}if(e%2===1){continue}if(l+f===k.length||k[l+f].offset>c.index){k.splice(l+f,0,{name:a++,optional:false,offset:c.index})}f++}n+=(d?"$":(n[n.length-1]==="/"?"":"(?=\\/|$)"));return new RegExp(n,b)};