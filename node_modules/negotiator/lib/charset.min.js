"use strict";module.exports=preferredCharsets;module.exports.preferredCharsets=preferredCharsets;var simpleCharsetRegExp=/^\s*([^\s;]+)\s*(?:;(.*))?$/;function parseAcceptCharset(d){var c=d.split(",");for(var b=0,a=0;b<c.length;b++){var e=parseCharset(c[b].trim(),b);if(e){c[a++]=e}}c.length=a;return c}function parseCharset(f,b){var a=simpleCharsetRegExp.exec(f);if(!a){return null}var g=a[1];var c=1;if(a[2]){var e=a[2].split(";");for(var b=0;b<e.length;b++){var d=e[b].trim().split("=");if(d[0]==="q"){c=parseFloat(d[1]);break}}}return{charset:g,q:c,i:b}}function getCharsetPriority(f,e,b){var d={o:-1,q:0,s:0};for(var c=0;c<e.length;c++){var a=specify(f,e[c],b);if(a&&(d.s-a.s||d.q-a.q||d.o-a.o)<0){d=a}}return d}function specify(d,a,b){var c=0;if(a.charset.toLowerCase()===d.toLowerCase()){c|=1}else{if(a.charset!=="*"){return null}}return{i:b,o:a.i,q:a.q,s:c}}function preferredCharsets(e,b){var d=parseAcceptCharset(e===undefined?"*":e||"");if(!b){return d.filter(isQuality).sort(compareSpecs).map(getFullCharset)}var c=b.map(function f(h,g){return getCharsetPriority(h,d,g)});return c.filter(isQuality).sort(compareSpecs).map(function a(g){return b[c.indexOf(g)]})}function compareSpecs(d,c){return(c.q-d.q)||(c.s-d.s)||(d.o-c.o)||(d.i-c.i)||0}function getFullCharset(a){return a.charset}function isQuality(a){return a.q>0};