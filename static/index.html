<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="Keywords" content="关键词">
		<meta name="Description" content="描述">
		<title>Web前端工程师</title>
		<link rel="stylesheet" type="text/css" href="css/base.css">
		<link rel="stylesheet" type="text/css" href="css/index.css">
	</head>
	<body>
	<!--头部-->
	<header id="header">
		<div class="nav">
			<div class="nav-left">
				<a href="#">
					<i class="icon">&#xe907</i>
					<p>Star'github</p>
				</a>
			</div>
			<div class="nav-right"><i class="icon">&#xf0ca</i></div>
		</div>
		<nav id="nav-ul">
			<ul>
				<li>新闻</li>
				<li>博文</li>
				<li>作品</li>
				<li>爱站</li>
				<li>关于我</li>
				<li>联系我</li>
			</ul>
		</nav>
	</header>
	<!--轮播图-->
	<section id="banners">
		<h2 style="display: none">banners</h2>
	<!--	<div class="banner-bg">
			<img src="images/banner1.jpg" alt="pic">
            <div class="banner-info">
                <h1 class="banner-title" >title description description description</h1>
                <p class="banner-description">description,description,description,description,description</p>
            </div>
		</div>
        <div class="banner-bg">
            <img src="images/banner2.jpg" alt="pic">
            <div class="banner-info">
                <h1 class="banner-title" >title description description description</h1>
                <p class="banner-description">description,description,description,description,description</p>
            </div>
        </div>
        <div class="banner-bg">
            <img src="images/banner3.jpg" alt="pic">
            <div class="banner-info">
                <h1 class="banner-title" >title description description description</h1>
                <p class="banner-description">description,description,description,description,description</p>
            </div>
        </div>-->

	</section>
	<!--技术新闻-->
	<section id="news">
		<h2><a href="./morenews.html">技术前沿</a></h2>
		<div class="news-container">
<!--			<div class="news-list-1 news-list">
				<span class="news-icon"><i class="icon">&#xf085</i></span>
				<h3 class="news-title">news-title,news-title</h3>
				<p class="news-summary">news-summary,news-summary,news-summary,news-summary</p>
				<a href="#" class="read-more">read more</a>
			</div>
			<div class="news-list-2 news-list">
				<span class="news-icon"><i class="icon">&#xe9a9</i></span>
				<h3 class="news-title">news-title,news-title</h3>
				<p class="news-summary">news-summary,news-summary,news-summary,news-summary</p>
				<a href="#" class="read-more">read more</a>
			</div>
			<div class="news-list-3 news-list">
				<span class="news-icon"><i class="icon">&#xf188</i></span>
				<h3 class="news-title">news-title,news-title</h3>
				<p class="news-summary">news-summary,news-summary,news-summary,news-summary</p>
				<a href="#" class="read-more">read more</a>
			</div>
			<div class="news-list-4 news-list">
				<span class="news-icon"><i class="icon">&#xe90a</i></span>
				<h3 class="news-title">news-title,news-title</h3>
				<p class="news-summary">news-summary,news-summary,news-summary,news-summary</p>
				<a href="#" class="read-more">read more</a>
			</div>-->
		</div>
	</section>
	<!--我的博文-->
	<section id="blogs">
		<h2><a href="./moreblogs.html">我的博文</a></h2>
		<div class="blogs-container">
<!--			<div class="blog-list-1 blog-list">
				<div class="blog-pic left"><img src="images/banner1.jpg" alt="pic"></div>
				<div class="blog right">
					<h3 class="blog-title">news-title,news-title</h3>
					<p class="blog-summary">news-summary,news-summary,news-summary,news-summary</p>
					<a href="#" class="read-more">read more</a>
				</div>
			</div>
			<div class="blog-list-2 blog-list">
				<div class="blog-pic left"><img src="images/banner1.jpg" alt="pic"></div>
				<div class="blog right">
					<h3 class="blog-title">news-title,news-title</h3>
					<p class="blog-summary">news-summarynews-summarynews-summarynews-summarynews-summary,news-summary,news-summary,news-summary</p>
					<a href="#" class="read-more">read more</a>
				</div>
			</div>-->
		</div>

	</section>
	<!--我的作品-->
	<section id="instros">
		<h2><a href="./intros.html">我的作品</a></h2>
		<div class="instros-container">
			<div class="instros-info left">
				<p>为君者，应领四方而兼济天下；</p>
				<p>为官者，当辅贤君而修身为民；</p>
				<p>为商者，须道以诚而心有神灵；</p>
				<p>为学者，必明事理而学以致用。</p>
			</div>
			<div class="instros-lists right ">
<!--				<div class="instros-list-1 instros-list">
					<img src="images/banner1.jpg" alt="pic">
					<a href="#" class="instros-list-info">
						<h4 class="instros-title">instros-title</h4>
						<p class="instros-description">instros-description,instros-description,instros-description</p>
					</a>
				</div>
				<div class="instros-list-2 instros-list">
					<img src="images/banner1.jpg" alt="pic">
					<a href="#" class="instros-list-info">
						<h4 class="instros-title">instros-title</h4>
						<p class="instros-description">instros-description,instros-description,instros-description</p>
					</a>
				</div>
				<div class="instros-list-3 instros-list">
					<img src="images/banner1.jpg" alt="pic">
					<a href="#" class="instros-list-info">
						<h4 class="instros-title">instros-title</h4>
						<p class="instros-description">instros-description,instros-description,instros-description</p>
					</a>
				</div>
				<div class="instros-list-4 instros-list">
					<img src="images/banner1.jpg" alt="pic">
					<a  href="#" class="instros-list-info">
						<h4 class="instros-title">instros-title</h4>
						<p class="instros-description">instros-description,instros-description,instros-description</p>
					</a>
				</div>-->
			</div>
		</div>
	</section>
	<!--喜欢去的网站-->
	<section id="friends" class="clr">
		<h2>学习站点</h2>
		<div class="friends-container">
			<div class="friends-info">
				<p>书山有路勤为径，学海无涯苦作舟。<br />我们只有多听多看多做，才能站得更高，走得更远。</p>
			</div>
			<div class="friends-show-list">
				<ul class="friends-list">

				</ul>
			</div>
            <i class="friends-icon-left icon">&#xf053</i>
            <i class="friends-icon-right icon">&#xf054</i>
		</div>
	</section>
	<!--关于我-->
	<section id="aboutme">
		<h2>关于我</h2>
		<div class="aboutme-container">
			<div class="aboutme-pic left">
				<!--<img src="images/banner1.jpg" alt="pic">-->
			</div>
			<div class="aboutme-info right">
<!--				<h3 class="aboutme-title">aboutme-title</h3>
				<p class="aboutme-content">aboutme-content,aboutme-content,ae-content,aboutme-contentaboutme-content</p>-->
			</div>
		</div>
	</section>
	<!--联系我-->
	<section id="msgs">
		<div class="msgs-contaniner">
			<div class="msgs-contact left">
				<h3 class="msgs-title">联系我</h3>
				<p class="msgs-detail">
					如果你喜欢前端，
					如果你热爱技术，
					如果你广交朋友，
					请一定要联系我。
				</p>
			</div>
			<div class="msgs-content right">
				<form>
					<div class="group">
						<input type="text" name="name" >
						<span class="light"></span>
						<label>Name</label>
					</div>
					<div class="group">
						<input type="text" name="email" >
						<span class="light"></span>
						<label>Email</label>
					</div>
					<div class="group">
						<input type="text" name="phone" >
						<span class="light"></span>
						<label>Phone</label>
					</div>
					<div class="group">
						<textarea name="subject"></textarea>
						<span class="light"></span>
						<label>Message</label>
					</div>
					<div class="group">
						<input type="button" class="msgs-submit" value="Send Message">
					</div>
				</form>
			</div>
		</div>
	</section>
	<!--尾部-->
	<footer id="footer">
		<div class="footer">
			<p>Star</p>
		</div>
	</footer>
	</body>

	<!--自定义插件-->
	<script type="text/javascript" charset="utf-8" src="./js/ajax.js"></script>
	<!--获取数据 渲染-->
	<script type="text/javascript" charset="utf-8">
		Friend();
		function Friend() {
            //获取数据
            getData({
                url:"/get_friends",
                data:null,
                callback:function (res) {
                    var friends	= formateFriends(res);
                    renderFriends(friends);
                    friendChange();

                }
            });
            //整理数据  包括数据遍历、拆分、重组等
            function formateFriends(data) {
                var friends = [];
                data.forEach(function (item) {
                    friends.push({
                        title:item.title,
                        description:item.description,
                        src:"/upload/"+item.src
                    });
                });
                return	friends;
            }
            //渲染数据
            function renderFriends(data) {
                var oFragment = document.createDocumentFragment();
                var oFriends = document.querySelector("#friends .friends-list");
                var len = data.length;
                for (var i=0 ;i<len;i++){
                    var item = document.createElement("li");
                    item.innerHTML = `<a href="#">
                            <img src="${data[i].src}" alt="pic">
                            <h3 class="friends-title">${data[i].title}</h3>
                            <p class="friends-description">${data[i].description}</p>
                        </a>`;
                    oFragment.appendChild(item);
                }
                oFriends.appendChild(oFragment);
            }
            //friends 轮播
            function friendChange() {
                var oLeft = document.querySelector(".friends-icon-left"),
                    oRight = document.querySelector(".friends-icon-right");
                var oShow = document.querySelector(".friends-show-list"),
                    oUl = document.querySelector(".friends-list");
                oUl.innerHTML += oUl.innerHTML;//复制一份列表
                var oLiArr = document.querySelectorAll(".friends-list li"),
                    len = oLiArr.length,
                    liWidth = oLiArr[0].offsetWidth + 100, //100为左右边距的和
                    ulWidth = len * liWidth,
                    timer = 0,
                    speed = -3;
                oUl.style.width = ulWidth + "px"; //初始化ul的长度  len
                timer = setInterval(move, 1000 / 60);
                oLeft.onclick = function () {
                    speed = -3;
                };
                oRight.onclick = function () {
                    speed = 3;
                };
                oUl.addEventListener("mouseover", stop, false);
                oUl.addEventListener("mouseout", play, false);
                function stop() {
                    clearInterval(timer);
                }
                function play() {
                    timer = setInterval(move, 1000 / 60);
                }
                function move() {
                    if(speed<0){
                        oUl.style.left = (oUl.offsetLeft >= - ulWidth/2) ? (oUl.offsetLeft + speed + "px" ): 0;
                    }else{
                        oUl.style.left =(oUl.offsetLeft < 0 ) ? (oUl.offsetLeft + speed + "px" ): - ulWidth/2 + "px";
                    }
                }
            }
        }
		Banner();
        function Banner() {
		    //获取数据
			getData({
				url:"/get_banners",
				data:null,
				callback:function (res) {
					var banners = formatBanners(res);
					renderBanners(banners);
                    bannerChange();
                }
			});
			//整理数据 数据的遍历 拆分 重组
			function formatBanners(data) {
			    var banners = [];
			    data.forEach(function (item) {
					banners.push({
                        title:item.title,
                        description:item.description,
                        href:item.href
					});
                });
			    return banners;
            }
            //渲染数据
            function renderBanners(data) {
                var oBanners = document.querySelector("#banners");
			    var len = data.length;
                var oFragment = document.createDocumentFragment();
			    for (var i=0 ; i<len;i++){
					var oDiv = document.createElement("div");
                    oDiv.className = "banner-bg";
					oDiv.innerHTML = `<img src="${data[i].href}" alt="pic">
					<div class="banner-info">
						<h1 class="banner-title" >${data[i].title}</h1>
						<p class="banner-description">${data[i].description}</p>
					</div>`;
                    oFragment.appendChild(oDiv);
				}
                oBanners.appendChild(oFragment);
            }

            //banner特效
            function bannerChange() {
                var aBannerList = document.querySelectorAll("#banners .banner-bg"),
                    timer = 0,
                    num = 0,
                    len = aBannerList.length;
                //初始化第一张背景图
                aBannerList[0].style.zIndex = 1;

                function zIndexChange() {
                    num %= len;
                    for (var i = 0; i < len; i++) {
                        aBannerList[i].style.zIndex = -1;
                    }
                    aBannerList[num].style.zIndex = 1;
                    num++;
                }

                timer = setInterval(zIndexChange, 3000);
            }

		}
		Aboutme();
        function Aboutme() {
			//获取数据
			getData({
				url:"/get_aboutme",
				data:null,
				callback:function (res) {
                    renderMe(res);
                }
			});
			//渲染数据
			function renderMe(data) {
                var oPic = document.querySelector("#aboutme .aboutme-pic");
                var oInfo = document.querySelector("#aboutme .aboutme-info");
				var oDiv = document.createElement("div");
                var oImg = document.createElement("img");
                oImg.src = `/upload/${data[0].pic_src}`;
                oImg.alt = "my photo";
				oDiv.innerHTML = `<h3 class="aboutme-title">${data[0].title}</h3>
				<p class="aboutme-content">${data[0].content}</p>`;
                oPic.appendChild(oImg);
                oInfo.appendChild(oDiv);
            }
        }
        News();
        function News() {
			//获取数据
			getData({
				url:"/get_news",
				data:{"start":0,"count":4},
				callback:function (res) {
				    var news = formateNews(res);
					//console.log(news);
                    renderNews(news);
                }
			});
			//整理数据
			function formateNews(data) {
				var news = [];
				data.forEach(function (item) {
					news.push({
						ID:item.ID,
						icon:"/upload/"+item.icon_src,
						title:cutWord(item.title,20),
						summary:cutWord(item.summary,80)
					});

                });
				return news;
            }
            //渲染数据
			function renderNews (data){
                var oNews = document.querySelector("#news  .news-container");
				var len = data.length;
				var oFragment = document.createDocumentFragment();
				for (var i=0;i<len;i++){
                    var oDiv = document.createElement("div");
                    oDiv.className = "news-list";
                    oDiv.innerHTML = `<img src="${data[i].icon}" width="512" height="512" alt="pic" class="news-icon">
									<h3 class="news-title">${data[i].title}</h3>
									<p class="news-summary">${data[i].summary}</p>
									<a href="/news.html?id=${data[i].ID}" class="read-more">read more</a>`;
                    oFragment.appendChild(oDiv);
				}
				oNews.appendChild(oFragment);
			}
        }
        Blog();
        function Blog() {
            //获取数据
            getData({
                url:"/get_blogs",
                data:{"start":0,"count":2},
                callback:function (res) {
                    //console.log(res);
                    var blogs = formateBlogs(res);
                    renderBlogs(blogs);
                }
            });

            function formateBlogs(data) {
                var blogs = [];
                data.forEach(function (item) {
                    blogs.push({
                        ID:item.ID,
                        picSrc:"/upload/"+item.pic_src,
                        title:cutWord(item.title,30),
                        summary:cutWord(item.summary,120)
                    });
                });
                return blogs;
            }
            function renderBlogs(data) {
                var oBlogBox = document.querySelector("#blogs .blogs-container");
                var oFrag = document.createDocumentFragment();
                for (var i=0,len=data.length;i<len;i++){
                    var oDiv = document.createElement("div");
                    oDiv.className = "blog-list";
                    oDiv.innerHTML = `<div class="blog-pic left"><img src="${data[i].picSrc}" alt="pic"></div>
				<div class="blog right">
					<h3 class="blog-title">${data[i].title}</h3>
					<p class="blog-summary">${data[i].summary}</p>
					<a href="/blog.html?id=${data[i].ID}" class="read-more">read more</a>
				</div>`;
                    oFrag.appendChild(oDiv);
                }
                oBlogBox.appendChild(oFrag);
            }
        }
		Intros();
		function Intros() {
            //获取数据
            getData({
                url:"/get_intros",
                data:{"start":0,"count":4},
                callback:function (res) {
                    var intros = formateIntros(res);
                    console.log(intros);
                    renderIntros(intros);
                }
            });
            //整理数据
            function formateIntros(data) {
                var intros = [];
                data.forEach(function (item) {
                    intros.push({
                        title:cutWord(item.title,20),
                        description:cutWord(item.description,100),
						href:item.href,
                        src:"/upload/"+item.src
                    });
                });
                return intros;
            }
            //渲染数据
            function renderIntros (data) {
                var oIntros = document.querySelector("#instros .instros-lists");
                var len = data.length;
                var oFragment = document.createDocumentFragment();
                for (var i = 0; i < len; i++) {
                    var oDiv = document.createElement("div");
                    oDiv.className = "instros-list";
                    oDiv.innerHTML = `<img src="${data[i].src}" alt="pic">
					<a href="#" class="instros-list-info">
						<h4 class="instros-title">${data[i].title}</h4>
						<p class="instros-description">${data[i].description}</p>
					</a>`;
                    oFragment.appendChild(oDiv);
                }
                oIntros.appendChild(oFragment);
            }
        }
        Msg();
		function Msg() {
            contactClick();
            //contact 联系我
            function contactClick() {
                var oContent = document.querySelector(".msgs-content"),
                    oInputList = oContent.querySelectorAll("form .group input"),
                    oTextarea = oContent.querySelector(".msgs-content form .group textarea"),
                    oLabelList = oContent.querySelectorAll(".msgs-content form .group label");
                var len = oInputList.length;
                oContent.addEventListener("click", function (e) {
                    var e = e || window.event;
                    var target = e.target;
                    switch (target.tagName.toLowerCase()) {
                        case "input":
                            for (var i = 0; i < len - 1; i++) {//给每个input 绑定获取焦点，失去焦点事件
                                oInputList[i].onfocus = function (i) {
                                    oLabelList[i].style.top = -20 + "px";
                                }.bind(oInputList[i],i);
                                oInputList[i].onblur = function (i) {
                                    if (this.value.length !== 0) {
                                        oLabelList[i].style.top = -20 + "px";
                                    } else {
                                        oLabelList[i].style.top = -5 + "px";
                                    }
                                }.bind(oInputList[i],i);
                            }
                            //sendMessage button 绑定点击事件
                            oInputList[len-1].onclick = function () {
                                console.log(this)
                               var data = checkMsg(oInputList,oTextarea);
                                if (data!=={}){//检查信息是否合理
									sendMessage(data);//合理则发送
								}
                            };
                            break;
                        case "textarea":
                            oTextarea.onfocus = function () {
                                oLabelList[len - 1].style.top = -20 + "px";
                                this.style.height = 100 + "px";
                            };
                            oTextarea.onblur = function () {
                                if (this.value.length !== 0) {
                                    oLabelList[len - 1].style.top = -20 + "px";
                                    this.style.height = 100 + "px";
                                } else {
                                    oLabelList[len - 1].style.top = -5 + "px";
                                    this.style.height = 40 + "px";
                                }
                            };
                            break;
                    }
                }, false);
            }
            function checkMsg(oInputList,oTextarea) {
                var name = oInputList[0].value;
                var email = oInputList[1].value;
                var phone = oInputList[2].value;
                var subject = oTextarea.value;
                var data = {};
				if(name === ""){
					alert("请输入您的姓名！");
                    oInputList[0].focus();
				}else if(email === ""){
					alert("请输入您的邮箱！");
                    oInputList[1].focus();
				}else if(!isEmail(email)){
                    alert("请输入合法的邮箱！");
                    oInputList[1].focus();
                }else if(phone === ""){
                    alert("请输入您的电话！");
                    oInputList[2].focus();
                }else if(!isPhone(phone)){
					alert("请输入合法的电话！");
                    oInputList[2].focus();
				}else if(subject === ""){
					alert("请输入您的留言！");
                    oTextarea.focus();
				}else {
                    data["name"] = name;
                    data["email"] = email;
                    data["phone"] = phone;
                    data["subject"] = subject;
					return data;
				}
            }
            function isEmail(str) {
                return /^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/.test(str);
            }
            function isPhone(str) {
                return /^1[34578]\d{9}$/.test(str)
            }
            function sendMessage(data) {
				sendData({
					url:"/post_msg",
					data:data,
					callback:function (res) {
					    if(res.Msg === "ok"){
					        alert("message has sent!")
						}else {
                            alert("sent fail!")
						}
                    }
				});
            }
        }
		//二次封装 ajax函数
		function getData(opt) {
			new myAjax({
				type: 'get',
				url: opt.url,
				data:opt.data,
				success:function (res) {
					opt["callback"] && opt["callback"](res);
				}
			});
		}
        function sendData(opt) {
            new myAjax({
                type: 'post',
                url: opt.url,
                data:opt.data,
                success:function (res) {
                    opt["callback"] && opt["callback"](res);
                }
            });
        }
		//cut  多余的字变省略号
		function cutWord(str,num) {
			var num = num || 50;
			var str = str || "";
			var len = str.length;
			var newStr = "";
			if(str === "" ){
			    return "false";
			}else {
			    return (len > num) ? (str.slice(0,num)+"...") : str ;
			}
        }
	</script>
	<!--菜单 icon点击特效 -->
	<script type="text/javascript" charset="utf-8" src="./js/menu-click.js"></script>
	<!--导航链接-->
	<script type="text/javascript" charset="utf-8">
	</script>

</html>